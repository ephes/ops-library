# Postfix PostgreSQL lookup - Sender/login mapping
# Generated by Ansible - do not edit manually
# Used with reject_sender_login_mismatch
# Schema mode: {{ mail_backend_schema_mode }}

user = {{ mail_backend_postgres_user }}
password = {{ mail_backend_postgres_password }}
hosts = {{ mail_backend_postgres_host }}
dbname = {{ mail_backend_postgres_database }}

{% if mail_backend_schema_mode == 'postfixadmin' %}
# PostfixAdmin: users can send as their own address or aliases pointing to them
# First part: mailbox owners can send as their username
# Second part: aliases allow sending as the alias address
query = SELECT username FROM mailbox WHERE LOWER(username) = LOWER('%s') AND active = '1' UNION SELECT goto FROM alias WHERE LOWER(address) = LOWER('%s') AND active = '1' AND goto LIKE '%%@%%'
{% else %}
query = SELECT login FROM mail_sender_login_view WHERE LOWER(sender) = LOWER('%s')
{% endif %}
