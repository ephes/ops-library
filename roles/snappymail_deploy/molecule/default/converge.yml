---
- name: Converge
  hosts: all
  become: true

  pre_tasks:
    - name: Ensure Ansible remote tmp exists
      ansible.builtin.file:
        path: /tmp/.ansible/tmp
        state: directory
        mode: "0700"

  vars:
    snappymail_admin_password: "molecule-pass"
    snappymail_data_dir: "/opt/snappymail-data"
    snappymail_traefik_enabled: false
    snappymail_healthcheck_enabled: false
    snappymail_listen_port: 8088
    snappymail_domains:
      - "example.test"

  roles:
    - role: snappymail_deploy
