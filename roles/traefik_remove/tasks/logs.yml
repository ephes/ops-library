---
# Remove Traefik log files and logrotate configuration

- name: Check if log directory exists
  ansible.builtin.stat:
    path: "{{ traefik_log_dir }}"
  register: traefik_log_dir_stat

- name: Remove log directory
  ansible.builtin.file:
    path: "{{ traefik_log_dir }}"
    state: absent
  when: traefik_log_dir_stat.stat.exists

- name: Check if logrotate config exists
  ansible.builtin.stat:
    path: "/etc/logrotate.d/traefik"
  register: traefik_logrotate_config

- name: Remove logrotate configuration
  ansible.builtin.file:
    path: "/etc/logrotate.d/traefik"
    state: absent
  when: traefik_logrotate_config.stat.exists

- name: Display log cleanup status
  ansible.builtin.debug:
    msg:
      - "âœ“ Log files cleaned up"
      - "  - Log directory: {{ 'removed' if traefik_log_dir_stat.stat.exists else 'did not exist' }}"
      - "  - Logrotate config: {{ 'removed' if traefik_logrotate_config.stat.exists else 'did not exist' }}"
