# Split DNS configuration - different responses per client network
# This file is only used in Advanced Mode

server:
  # Map client networks to views
  access-control-view: {{ dns_split_lan_network }} "lan"
  access-control-view: {{ dns_split_tailscale_network }} "tailscale"
  access-control-view: 127.0.0.0/8 "localhost"

# LAN view - internal network clients
view:
  name: "lan"
  view-first: yes

  # Redirect zone for wildcard behavior
  local-zone: "{{ dns_local_domain }}." redirect
  local-data: "{{ dns_local_domain }}. IN A {{ dns_split_lan_ip }}"

  local-zone: "{{ dns_local_domain_punycode }}." redirect
  local-data: "{{ dns_local_domain_punycode }}. IN A {{ dns_split_lan_ip }}"

  # Service-specific overrides (optional)
  # IMPORTANT: These specific local-data entries take precedence over the redirect wildcard
  # Use for services that need different IPs than the wildcard default
{% for service in dns_split_services %}
  local-data: "{{ service.name }}.{{ dns_local_domain }}. IN A {{ service.lan_ip }}"
  local-data: "{{ service.name }}.{{ dns_local_domain_punycode }}. IN A {{ service.lan_ip }}"
{% endfor %}

# Tailscale view - Tailscale network clients
view:
  name: "tailscale"
  view-first: yes

  # Redirect zone for wildcard behavior
  local-zone: "{{ dns_local_domain }}." redirect
  local-data: "{{ dns_local_domain }}. IN A {{ dns_split_tailscale_ip }}"

  local-zone: "{{ dns_local_domain_punycode }}." redirect
  local-data: "{{ dns_local_domain_punycode }}. IN A {{ dns_split_tailscale_ip }}"

  # Service-specific overrides (optional)
  # IMPORTANT: These specific local-data entries take precedence over the redirect wildcard
  # Use for services that need different IPs than the wildcard default
{% for service in dns_split_services %}
  local-data: "{{ service.name }}.{{ dns_local_domain }}. IN A {{ service.tailscale_ip }}"
  local-data: "{{ service.name }}.{{ dns_local_domain_punycode }}. IN A {{ service.tailscale_ip }}"
{% endfor %}

# Localhost view
view:
  name: "localhost"
  view-first: yes

  # Redirect zone for wildcard behavior
  local-zone: "{{ dns_local_domain }}." redirect
  local-data: "{{ dns_local_domain }}. IN A {{ dns_split_lan_ip }}"

  local-zone: "{{ dns_local_domain_punycode }}." redirect
  local-data: "{{ dns_local_domain_punycode }}. IN A {{ dns_split_lan_ip }}"