---
- name: Assert telegram_bot_token is set
  ansible.builtin.assert:
    that:
      - telegram_bot_token | length > 0
    fail_msg: >
      telegram_bot_token is required.
      Obtain a token from @BotFather on Telegram.

- name: Assert telegram_bot_token is not a placeholder
  ansible.builtin.assert:
    that:
      - telegram_bot_token != 'CHANGEME'
    fail_msg: >
      telegram_bot_token still contains the placeholder value.

- name: Assert telegram_bot_anthropic_api_key is set
  ansible.builtin.assert:
    that:
      - telegram_bot_anthropic_api_key | length > 0
    fail_msg: >
      telegram_bot_anthropic_api_key is required.

- name: Assert telegram_bot_anthropic_api_key is not a placeholder
  ansible.builtin.assert:
    that:
      - telegram_bot_anthropic_api_key != 'CHANGEME'
    fail_msg: >
      telegram_bot_anthropic_api_key still contains the placeholder value.

- name: Assert telegram_bot_max_tokens is a positive integer
  ansible.builtin.assert:
    that:
      - telegram_bot_max_tokens | int > 0
    fail_msg: >
      telegram_bot_max_tokens must be a positive integer (got {{ telegram_bot_max_tokens }}).

- name: Assert telegram_bot_extra_env is a mapping
  ansible.builtin.assert:
    that:
      - telegram_bot_extra_env is mapping
    fail_msg: >
      telegram_bot_extra_env must be a mapping/dict, not a string.

- name: Assert required paths are configured
  ansible.builtin.assert:
    that:
      - telegram_bot_site_dir | length > 0
      - telegram_bot_data_dir | length > 0
    fail_msg: >
      telegram_bot_site_dir and telegram_bot_data_dir must be set.
