# Managed by Ansible (openclaw_deploy). Do not edit on the host.

http:
  routers:
    openclaw:
      rule: "Host(`{{ openclaw_traefik_host }}`)"
      entryPoints:
{% for ep in openclaw_traefik_entrypoints %}
        - {{ ep }}
{% endfor %}
{% if openclaw_traefik_ip_allowlist | length > 0 %}
      middlewares:
        - openclaw-ipallow
{% endif %}
      service: openclaw
{% if openclaw_traefik_cert_resolver | default('') | length > 0 %}
      tls:
        certResolver: {{ openclaw_traefik_cert_resolver }}
{% else %}
      tls: {}
{% endif %}

{% if openclaw_traefik_ip_allowlist | length > 0 %}
  middlewares:
    openclaw-ipallow:
      ipAllowList:
        sourceRange:
{% for cidr in openclaw_traefik_ip_allowlist %}
          - "{{ cidr }}"
{% endfor %}

{% endif %}
  services:
    openclaw:
      loadBalancer:
        servers:
          - url: "http://127.0.0.1:{{ openclaw_host_port }}"
