---
# Nyxmon deployment role defaults
# These are safe defaults that can be public
# Sensitive values should be overridden in ops-control

# User and paths
nyxmon_user: nyxmon
nyxmon_group: "{{ nyxmon_user }}"
nyxmon_home: /home/nyxmon
nyxmon_site_path: "{{ nyxmon_home }}/site"
nyxmon_venv_path: "{{ nyxmon_site_path }}/.venv"
nyxmon_venv_bin: "{{ nyxmon_venv_path }}/bin"
nyxmon_cache_dir: "{{ nyxmon_site_path }}/cache"

# Deployment method
nyxmon_deploy_method: rsync  # Options: rsync, git

# Source for rsync method (required for development)
nyxmon_source_path: ""  # REQUIRED for rsync - e.g., /Users/jochen/projects/nyxmon
# When using rsync, copy these additional source directories to the target host
nyxmon_rsync_additional_paths:
  - src/nyxmon/
  - src/nyxboard/
# Additional individual files to copy from source
nyxmon_rsync_extra_files:
  - README.md
# Whether to reuse the project's pyproject.toml from nyxmon_source_path (rsync)
nyxmon_use_source_pyproject: true

# Git settings (for production deployment via FastDeploy)
nyxmon_git_repo: "git@github.com:ephes/nyxmon.git"
nyxmon_git_version: main
nyxmon_git_subdirectory: "src/django"  # Django app is in subdirectory

# Application settings
nyxmon_app_port: 10017
nyxmon_app_host: "127.0.0.1"
nyxmon_workers: 4

# Django settings
nyxmon_django_settings_module: "config.settings.production"
nyxmon_django_allowed_hosts: "127.0.0.1"
nyxmon_django_admin_url: "admin/"
# REQUIRED - Must be provided, no default for security
# nyxmon_django_secret_key: ""
nyxmon_django_debug: false

# Telegram settings (for monitoring)
# REQUIRED - Must be provided, no defaults for security
# nyxmon_telegram_bot_token: ""
# nyxmon_telegram_chat_id: ""

# Traefik configuration
nyxmon_traefik_enabled: true
nyxmon_traefik_host: "nyxmon.example.com"  # Override in ops-control
nyxmon_traefik_cert_resolver: letsencrypt
nyxmon_traefik_middlewares: []

# Traefik dual router authentication (SECURITY: mandatory for public-facing services)
nyxmon_basic_auth_enabled: true  # Follows security policy - dual router pattern
nyxmon_basic_auth_user: "admin"
# REQUIRED when basic_auth_enabled=true - Must be provided, no default for security
# nyxmon_basic_auth_password: "CHANGEME"

# Internal network IP ranges (for dual router pattern)
# These clients bypass basic auth (internal router)
nyxmon_internal_ip_ranges:
  - "192.168.0.0/16"      # RFC1918 private
  - "10.0.0.0/8"          # RFC1918 private
  - "172.16.0.0/12"       # RFC1918 private
  - "100.64.0.0/10"       # Tailscale CGNAT
  - "fd7a:115c:a1e0::/48" # Tailscale IPv6
  - "fd50:3e45:c454:0::/64" # ULA IPv6
  - "2a02:3100:3d40:9c00::/64" # ISP IPv6 (customize per deployment)

# Monitoring
nyxmon_monitoring_enabled: true
nyxmon_monitoring_service_name: nyxmon_monitor

# Python package management
nyxmon_use_uv: true  # Use uv for package management
nyxmon_python_version: "3.13"  # Python version (3.14 not yet supported by uvloop as of Oct 2025)

# Service restart
nyxmon_service_restart_on_change: true

# Node.js version (if frontend build is needed)
nyxmon_node_version: 20
